<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>دفتر الحسابات - متجر أرتل</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/accounting.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- مكتبات التصدير -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-container">
            <div class="logo">
                <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIwIDBDOC45NiAwIDAgOC45NiAwIDIwQzAgMzEuMDQgOC45NiA0MCAyMCA0MEMzMS4wNCA0MCA0MCAzMS4wNCA0MCAyMEM0MCA4Ljk2IDMxLjA0IDAgMjAgMFpNMjggMjZMMjIgMzJMMTYgMjZMMjAgMjJMMjYgMjJMMjggMjZaIiBmaWxsPSIjMGE1YzM2Ii8+Cjwvc3ZnPgo=" alt="أرتل">
                <h1>دفتر الحسابات - متجر أرتل</h1>
            </div>
            
            <div class="mobile-toggle">
                <i class="fas fa-bars"></i>
            </div>
            
            <nav>
                <ul class="nav-menu">
                    <li><a href="index.html">الموقع الرئيسي</a></li>
                    <li><a href="Control_panel.html">لوحة التحكم</a></li>
                    <li><a href="#" class="nav-link active" data-section="transactions">الحركات المالية</a></li>
                    <li><a href="#" class="nav-link" data-section="reports">التقارير</a></li>
                    <li><a href="#" class="nav-link" data-section="categories">التصنيفات</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="container">
        <!-- Accounting Summary -->
        <div class="accounting-summary">
            <div class="summary-card income">
                <h4>إجمالي الإيرادات</h4>
                <div class="amount" id="totalIncome">0 ر.ي</div>
                <small>هذا الشهر: <span id="monthlyIncome">0 ر.ي</span></small>
            </div>
            <div class="summary-card expenses">
                <h4>إجمالي المصروفات</h4>
                <div class="amount" id="totalExpenses">0 ر.ي</div>
                <small>هذا الشهر: <span id="monthlyExpenses">0 ر.ي</span></small>
            </div>
            <div class="summary-card balance">
                <h4>صافي الربح</h4>
                <div class="amount" id="netProfit">0 ر.ي</div>
                <small>هذا الشهر: <span id="monthlyProfit">0 ر.ي</span></small>
            </div>
            <div class="summary-card">
                <h4>الرصيد النقدي</h4>
                <div class="amount" id="cashBalance">0 ر.ي</div>
                <small>آخر تحديث: <span id="lastUpdate">اليوم</span></small>
            </div>
        </div>

        <!-- Transactions Section -->
        <section id="transactions" class="section active">
            <!-- Add Transaction Form -->
            <div class="form-section">
                <div class="section-title">
                    <h3><i class="fas fa-plus-circle"></i> إضافة حركة مالية</h3>
                </div>
                
                <form id="addTransactionForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="transactionType">نوع الحركة</label>
                            <select id="transactionType" class="form-control" required>
                                <option value="">اختر نوع الحركة</option>
                                <option value="income">إيراد</option>
                                <option value="expense">مصروف</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="transactionAmount">المبلغ (ر.ي)</label>
                            <input type="number" id="transactionAmount" class="form-control" min="0" step="0.01" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="transactionDate">التاريخ</label>
                            <input type="date" id="transactionDate" class="form-control" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="transactionCategory">التصنيف</label>
                            <select id="transactionCategory" class="form-control" required>
                                <option value="">اختر التصنيف</option>
                                <optgroup label="الإيرادات" id="incomeCategories">
                                    <!-- سيتم ملؤها ديناميكياً -->
                                </optgroup>
                                <optgroup label="المصروفات" id="expenseCategories">
                                    <!-- سيتم ملؤها ديناميكياً -->
                                </optgroup>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="transactionPaymentMethod">طريقة الدفع</label>
                            <select id="transactionPaymentMethod" class="form-control" required>
                                <option value="">اختر طريقة الدفع</option>
                                <option value="cash">نقدي</option>
                                <option value="bank-transfer">تحويل بنكي</option>
                                <option value="card">بطاقة ائتمان</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="transactionDescription">وصف الحركة</label>
                        <textarea id="transactionDescription" class="form-control" required></textarea>
                    </div>
                    
                    <button type="submit" class="btn"><i class="fas fa-save"></i> حفظ الحركة</button>
                </form>
            </div>

            <!-- Transactions List -->
            <div class="form-section">
                <div class="section-title">
                    <h3><i class="fas fa-list"></i> الحركات المالية</h3>
                </div>
                
                <!-- Filters -->
                <div class="filters">
                    <div class="filter-group">
                        <label for="filterType">نوع الحركة</label>
                        <select id="filterType" class="form-control">
                            <option value="">الكل</option>
                            <option value="income">إيراد</option>
                            <option value="expense">مصروف</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="filterCategory">التصنيف</label>
                        <select id="filterCategory" class="form-control">
                            <option value="">الكل</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="filterDateFrom">من تاريخ</label>
                        <input type="date" id="filterDateFrom" class="form-control">
                    </div>
                    
                    <div class="filter-group">
                        <label for="filterDateTo">إلى تاريخ</label>
                        <input type="date" id="filterDateTo" class="form-control">
                    </div>
                    
                    <div class="filter-group">
                        <label>&nbsp;</label>
                        <button class="btn btn-info" id="applyFilters"><i class="fas fa-filter"></i> تطبيق الفلتر</button>
                    </div>
                </div>
                
                <!-- Desktop Table -->
                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>التاريخ</th>
                                <th>النوع</th>
                                <th>التصنيف</th>
                                <th>الوصف</th>
                                <th>المبلغ</th>
                                <th>طريقة الدفع</th>
                                <th>الإجراءات</th>
                            </tr>
                        </thead>
                        <tbody id="transactionsTableBody">
                            <!-- الحركات سيتم تحميلها ديناميكياً -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Mobile Cards -->
                <div class="mobile-cards" id="transactionsMobileCards">
                    <!-- الحركات سيتم تحميلها ديناميكياً -->
                </div>
            </div>
        </section>

        <!-- Reports Section -->
        <section id="reports" class="section">
            <!-- Reports Summary -->
            <div class="reports-cards">
                <div class="report-card">
                    <i class="fas fa-chart-line"></i>
                    <h3 id="totalTransactions">0</h3>
                    <p>إجمالي الحركات</p>
                </div>
                <div class="report-card">
                    <i class="fas fa-money-bill-wave"></i>
                    <h3 id="avgTransaction">0 ر.ي</h3>
                    <p>متوسط قيمة الحركة</p>
                </div>
                <div class="report-card">
                    <i class="fas fa-calendar-alt"></i>
                    <h3 id="monthlyTransactions">0</h3>
                    <p>حركات هذا الشهر</p>
                </div>
                <div class="report-card">
                    <i class="fas fa-exchange-alt"></i>
                    <h3 id="incomeExpenseRatio">0%</h3>
                    <p>نسبة الإيرادات إلى المصروفات</p>
                </div>
            </div>

            <!-- Charts -->
            <div class="charts-grid">
                <div class="chart-container">
                    <div class="section-title">
                        <h3><i class="fas fa-chart-pie"></i> توزيع الإيرادات والمصروفات</h3>
                    </div>
                    <canvas id="incomeExpenseChart"></canvas>
                </div>
                
                <div class="chart-container">
                    <div class="section-title">
                        <h3><i class="fas fa-chart-bar"></i> الإيرادات والمصروفات الشهرية</h3>
                    </div>
                    <canvas id="monthlyTrendChart"></canvas>
                </div>
                
                <div class="chart-container">
                    <div class="section-title">
                        <h3><i class="fas fa-chart-pie"></i> توزيع المصروفات حسب التصنيف</h3>
                    </div>
                    <canvas id="expensesByCategoryChart"></canvas>
                </div>
                
                <div class="chart-container">
                    <div class="section-title">
                        <h3><i class="fas fa-chart-bar"></i> توزيع الإيرادات حسب التصنيف</h3>
                    </div>
                    <canvas id="incomeByCategoryChart"></canvas>
                </div>
            </div>

            <!-- Export Reports -->
            <div class="form-section">
                <div class="section-title">
                    <h3><i class="fas fa-download"></i> تصدير التقارير</h3>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="exportFormat">نوع الملف</label>
                        <select id="exportFormat" class="form-control">
                            <option value="pdf">PDF</option>
                            <option value="excel">Excel</option>
                            <option value="csv">CSV</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="exportDateFrom">من تاريخ</label>
                        <input type="date" id="exportDateFrom" class="form-control">
                    </div>
                    
                    <div class="form-group">
                        <label for="exportDateTo">إلى تاريخ</label>
                        <input type="date" id="exportDateTo" class="form-control">
                    </div>
                </div>
                
                <button class="btn btn-success" id="exportReport"><i class="fas fa-file-export"></i> تصدير التقرير</button>
            </div>
        </section>

        <!-- Categories Section -->
        <section id="categories" class="section">
            <div class="form-section">
                <div class="section-title">
                    <h3><i class="fas fa-tags"></i> إدارة التصنيفات</h3>
                    <button class="btn btn-info" id="addCategoryBtn"><i class="fas fa-plus"></i> إضافة تصنيف</button>
                </div>
                
                <div class="form-row">
                    <!-- Income Categories -->
                    <div class="form-group">
                        <h4 style="margin-bottom: 15px; color: var(--success);">تصنيفات الإيرادات</h4>
                        <div id="incomeCategoriesList" class="categories-list">
                            <!-- سيتم ملؤها ديناميكياً -->
                        </div>
                    </div>
                    
                    <!-- Expense Categories -->
                    <div class="form-group">
                        <h4 style="margin-bottom: 15px; color: var(--danger);">تصنيفات المصروفات</h4>
                        <div id="expenseCategoriesList" class="categories-list">
                            <!-- سيتم ملؤها ديناميكياً -->
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script src="js/main.js"></script>
    <script src="js/accounting.js"></script>
</body>
    </html>
